<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport"
    content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
  <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
  <title>{{$t("lang.lotteryTitle")}}</title>
  <script src="../../script/vue.min.js"></script>
  <script src="../../script/vue-i18n.min.js"></script>
  <script src="../../script/vant.min.js"></script>
  <script src="../../script/country-code.js"></script>

  <script src="../../i18n/zh-cn.js"></script>
  <script src="../../i18n/zh-tw.js"></script>
  <script src="../../i18n/en.js"></script>
  <script src="../../i18n/ja.js"></script>
  <script src="../../i18n/ko.js"></script>
  <script src="../../i18n/ar.js"></script>
  <script src="../../i18n/ms.js"></script>
  <script src="../../i18n/tr.js"></script>
  <script src="../../i18n/vi.js"></script>
  <script src="../../i18n/id.js"></script>
  <script src="../../script/jquery.min.js"></script>
  <script src="../../script/jquery.md5.js"></script>
  <script src="../../script/api.js"></script>
  <script src="../../script/webservice.js"></script>
  <script src="../../script/lottery.js"></script>

  <link rel="stylesheet" type="text/css" href="../../css/index.css" />
  <link rel="stylesheet" type="text/css" href="../../css/api.css" />
  <link rel="stylesheet" type="text/css" href="../../css/app.css" />
  <style>
    html,
    body {
      overflow-x: hidden;
      background: url(../../image/img/lottery_bg.png)no-repeat;
      width: 100%;
      height: 100%;
      background-size: 100% 100%;
      position: absolute;
    }

    .lottery_topbar {
      padding-top: 8vw;
      padding-bottom: 4vw;
      width: 100%;
      height: 12vw;
      background-size: cover;
      align-items: center;
      -webkit-align-items: center;
      text-align: center;
      -webkit-text-align: center;
      font-size: 22px;
      color: #ffffff;
    }

    .notice {
         width: 100%;
      height: 40px;
      border-radius: 8px;
      border: 1px solid #eee;
      margin: 10px auto;
      overflow: hidden;
    }

    .notice__inner {
      animation: roll 36s linear infinite;
      margin-top: 0
    }

    .notice__item {
      font-size: 14px;
      height: 40px;
      line-height: 40px;
      padding: 0 12px;
      white-space: nowrap;
      text-decoration: underline;
    }

    @keyframes roll {
      0% {
        margin-top: 0;
      }

      4% {
        margin-top: 0;
      }

      8% {
        margin-top: 0;
      }

      12% {
        margin-top: -40px;
      }

      16% {
        margin-top: -40px;
      }

      20% {
        margin-top: -80px;
      }

      24% {
        margin-top: -80px;
      }

      28% {
        margin-top: -120px;
      }

      32% {
        margin-top: -120px;
      }

      36% {
        margin-top: -160px;
      }

      40% {
        margin-top: -160px;
      }

      44% {
        margin-top: -200px;
      }

      48% {
        margin-top: -200px;
      }

      52% {
        margin-top: -240px;
      }

      56% {
        margin-top: -240px;
      }

      60% {
        margin-top: -200px;
      }

      64% {
        margin-top: -200px;
      }

      68% {
        margin-top: -160px;
      }

      72% {
        margin-top: -160px;
      }

      76% {
        margin-top: -120px;
      }

      80% {
        margin-top: -120px;
      }

      84% {
        margin-top: -80px;
      }

      88% {
        margin-top: -80px;
      }

      92% {
        margin-top: -40px;
      }

      96% {
        margin-top: -40px;
      }

      100% {
        margin-top: 0;
      }
    }

    .lottery_number {
      width: 200px;
      height: 36px;
      line-height: 36px;
      margin-top: 20px;
      margin-bottom: 120px;
      margin-left: auto;
      margin-right: auto;
      color: #fff;
      text-align: center;
      background-color: #f2004c;
    }

    #lottery-wrap {
      position: relative;
      display: block;
      margin-left: auto;
      margin-right: auto;
      width: 300px;
      border: 8px solid #eac34c;
      border-radius: 50%;
      box-shadow: 3px 0 3px #fffdc9, 0px 3px 3px #fffdc9, -3px 0 3px #fffdc9, 0px -3px 3px #fffdc9;
    }

    canvas {
      display: block;
    }

    #lottery-handler {
      position: absolute;
      z-index: 2;
      width: 60px;
      height: 74px;
      left: 50%;
      top: 50%;
      margin: -44px 0 0 -30px;
      background: url(../../image/img/handler2.png) no-repeat 50%;
      background-size: contain;
    }

    .invitation_title {
      font-weight: bold;
      font-size: 18px;
      margin: 40px 0;
      padding: 0 20px;
    }
  </style>
</head>

<body>
  <div class="lottery_topbar flex flex-h flex-center-v">
    <img class="btn-back" src="../../image/img/arrow-left.png" @click="cancel"></img>
    <span class="flex-1 flex-center">{{$t("lang.lotteryTitle")}}</span>
  </div>
  <div class="notice flex flex-h flex-center-v">
    <div class="notice__inner">
      <div class="notice__item">HTTPå‡çº§HTTPSå…¨è¿‡ç¨‹ï¼ŒNginxé…ç½®å¹³æ»‘å‡çº§</div>
      <div class="notice__item">ä¸€å°ç”µè„‘å­˜åœ¨å¤šä¸ªç‰ˆæœ¬çš„Vuecliï¼Œæ–¹ä¾¿å¿«é€Ÿåˆå§‹åŒ–ä¸åŒç‰ˆæœ¬çš„Vueé¡¹ç›®</div>
      <div class="notice__item">å‰ç«¯æ¨¡å—åŒ–è§„èŒƒå®šä¹‰-ä¸åŒè§„èŒƒä¸‹çš„å¯¼å…¥å¯¼å‡º</div>
      <div class="notice__item">å¿«é€Ÿã€ç®€æ´è®²æ˜Vueä¸­v-forå¾ªç¯keyçš„ä½œç”¨</div>
      <div class="notice__item">Callä¸Applyå‡½æ•°çš„åˆ†æåŠæ‰‹å†™å®ç°</div>
      <div class="notice__item">æ™®é€šåˆ‡å›¾ä»”çš„ä¸€å¹´ | æ˜é‡‘å¹´åº¦å¾æ–‡</div>
      <div class="notice__item">å‰ç«¯éœ€è¦äº†è§£çš„æµè§ˆå™¨ç¼“å­˜ï¼ˆå³HTTPç¼“å­˜ï¼‰| ğŸ† æŠ€æœ¯ä¸“é¢˜ç¬¬å…«æœŸå¾æ–‡</div>
    </div>
  </div>
  <div class="lottery_number">
    ä½ è¿˜æœ‰{{lotteryCount}}æ¬¡æŠ½å¥–æœºä¼š
  </div>
  <div id="lottery-wrap">
    <div id="lottery-handler"></div>
    <canvas width="300" height="300" id="lottery"></canvas>
  </div>
  <div class="invitation_title">
    <h3>å¦‚ä½•å‚ä¸ï¼š</h3>
    1.åœ¨APPå†…7å¤©æœ‰æ•ˆç«æŠ•ç´¯è®¡æ•°é¢è¶…è¿‡1000FEC <br>
    2.æŠ¥ååŸ¹è®­çš„ç”¨æˆ·ï¼Œå¿…é¡»è¿ç»­7å¤©å‚ä¸ç«æŠ•ï¼Œæ¯å¤©è‡³å°‘ç«æŠ•1FEC <br>
    3.æ¯ä¸ªè´¦æˆ·æ»¡è¶³ä»¥ä¸Šä»»æ„æ¡ä»¶å³å¯è·å¾—ä¸€æ¬¡æŠ½å¥–èµ„æ ¼ï¼Œä»…é™å‚ä¸ä¸€æ¬¡<br>
    4.çº¿ä¸Šçº¿ä¸‹å·²ä¸­è¿‡å¥–çš„ç”¨æˆ·å°†æ— æ³•é‡å¤å‚ä¸<br><br>


    <h3> æ´»åŠ¨æ—¶é—´ï¼š</h3>
    å³æ—¥èµ·è‡³2022å¹´2æœˆ28æ—¥24ç‚¹ GMT+8<br><br>

    <h3>å¥–åŠ±è®¾ç½®ï¼š</h3>
    ä¸€ç­‰å¥–: 15,888 FEC<br>
    äºŒç­‰å¥–: 8,888 FEC<br>
    ä¸‰ç­‰å¥–: 2,888 FEC<br>
    å››ç­‰å¥–: 588 FEC <br>
    äº”ç­‰å¥–: 188 FEC<br>
    å…­ç­‰å¥–: 88 FEC <br><br>

    æ¬²äº†è§£æ›´å¤šç²¾å½©æ´»åŠ¨ï¼Œæ¬¢è¿åŠ å…¥FESç”µæŠ¥ç¾¤ã€‚<br>
    FECäºšå¤ªå…±è¯†ç¾¤ï¼š<a href="https://t.me/+l3mdJzsapLRkNGE1">https://t.me/+l3mdJzsapLRkNGE1</a><br>
    FESå®˜æ–¹é¢‘é“ï¼š<a href="https://t.me/FiveElementSystemChannelCN">https://t.me/FiveElementSystemChannelCN</a> <br>
    ç‚¹å‡»ä¸Šæ–¹è“è‰²é“¾æ¥â€œåŠ å…¥â€, å¹¶ç‚¹å‡»â€œå¼€å¯é€šçŸ¥â€å³å¯<br><br>

    *æ´»åŠ¨æœ€ç»ˆè§£é‡Šæƒå½’FESæ‰€æœ‰<br><br>
  </div>
</body>

<script>
  var vueObj = {
    el: '#game',
    i18n,
    data() {
      return {
        lotteryCount: 0,
        products: []
      };
    },
    filters: {
      email: function(value) {
        if (value && value.length > 6) {
          let str = value.split("@");
          return str[0].substr(0, str[0].length - 2) + "*****" + str[1].substr(2);
        } else {
          return value
        }
      },
      name: function(value) {
        if (value && value.length > 2) {
          return "*" + value.substring(value.length - 2);
        } else {
          return value
        }
      },
    },

    created() {
      POST(lotteryCount(), { token: api.getPrefs({ sync: true, key: KEY_TOKEN }), }, (ret, err) => {
        this.lotteryCount = ret.data;
      });

    },
    methods: {
      lotterydialogBox(amount) {
        var dialogBox = api.require('dialogBox');
        dialogBox.taskPlan({
          rect: {
            w: 300,
          },
          texts: {
            content: [{
              text: `æ­å–œæ‚¨è·å¾—${amount}FEC`
            }],
            btnTitle: 'ç«‹å³é¢†å–'
          },
          styles: {
            bg: '../../image/img/dialogBox_lottery2.png',
            content: [{
              bg: 'rgba(254,254,254,0.5)',
              marginT: 220,
              marginL: 60,
              w: 180,
              align: 'center',
              color: '#fff',
              size: 12
            }],
            ok: {
              marginT: 20,
              marginB: 40,
              marginL: 108,
              w: 80,
              h: 36,
              bg: '#eac34c',
              color: '#fff',
              size: 12
            }
          }
        }, function(ret) {
          if (ret.eventType == 'ok') {
            var dialogBox = api.require('dialogBox');
            dialogBox.close({
              dialogName: 'taskPlan'
            });
          }
        });


      },

      cancel() {
        api.closeWin();
      },
      /*æ¨¡æ‹Ÿajaxè¯·æ±‚æ•°æ®è¿”å›*/
      _ajax(callback) {
        /*jQuery.ajax({
          url: url,
          data: data,
          success: function(response){
            callback && callback(response);
          }
        })*/
        setTimeout(() => {
          var _index = Math.floor(Math.random() * this.products.length);
          var response = { id: 1, name: this.products[_index].name, index: _index };
          callback && callback(response);
        }, 100);
      }
    },
    mounted() {
      POST(initDrawLis(), { token: api.getPrefs({ sync: true, key: KEY_TOKEN }), }, (ret, err) => {
        const initDrawLis = ret.data;

        initDrawLis.forEach(element => {
          this.products.push({
            "imgUrl": "../../image/img/redpacket.png",
            "name": element.prize + 'FES',
            "id": element.id,
            "prize": element.prize,
          })
        });
        new Lottery(document.getElementById('lottery'), {
          handler: document.getElementById('lottery-handler'),
          handlerCallback: (_interface) => {
            // if(this.lotteryCount < 1){
            //     alertSingle('ä½ çš„æŠ½å¥–æœºä¼šå·²ç”¨å®Œï¼');
            //     return false;
            // }
            /*ajaxè·å–ä¸­å¥–ç»“æœ*/
            this._ajax((response) => {

              /*æŒ‡å®šåœæ­¢çš„ä½ç½®:ç´¢å¼•*/
              _interface.stop(response.index, () => {
                const product = this.products[response.index]
                this.lotterydialogBox(product.prize)
              });
            });
          },
          images: {
            width: 22,
            height: 29,
            y: '88%',
          },
          products: this.products
        });


      });
    },
  };
  setLanguage = function() {
    if (api.getPrefs({ sync: true, key: KEY_LANGUAGE })) {
      i18n.locale = api.getPrefs({ sync: true, key: KEY_LANGUAGE });
    }
  }
  apiready = function() {
    window.appInfo = new Vue(vueObj);
    setLanguage();
  }
</script>

</html>